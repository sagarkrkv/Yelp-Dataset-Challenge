We had tried many different methods, here is code for the different other trails that we have not used eventually.